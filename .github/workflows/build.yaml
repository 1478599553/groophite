name: Build Mod
on: [push]
jobs:
  Build-Mod:
    runs-on: windows-2019
    #runs-on: ubuntu-latest
    steps:

      - run: |
          mkdir %APPDATA%/buildMod
          cd %APPDATA%/buildMod
          git clone https://github.com/1478599553/groophite.git
          cd ./groophite
          python %APPDATA%/buildMod/groophite/CIUtils/utils.py
          ./gradlew.bat build

          ./CIUtils/7z a ./build/groophite-release.zip ./build/libs/
          Copy ./build/groophite-release.zip %APPDATA%/groophite.zip
          cd %APPDATA%/buildMod
          git clone https://github.com/1478599553/artifacts.git
          python %APPDATA%/buildMod/groophite/CIUtils/utils.py postBuild
          cd %APPDATA%/buildMod/artifacts
          git add -A
          git commit -m "autobuild"
          git push origin main
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
      - name: artifact
        uses: actions/download-artifact@v1
        with:
          name: Groophite
          path: ~/groophite
      - run: echo "üñ•Ô∏è The workflow is now ready to test your code on the runner."
      - name: List files in the repository
        run: |
          ls ${{ github.workspace }}
      - run: echo "üçè This job's status is ${{ job.status }}."
      #- name: Upload to release
      #  uses: JasonEtco/upload-to-release@master
      #  with:
      #    args: build/libs/*.jar application/octet-stream
#  env:
#    GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
